<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Game Container</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #111;
  color: #eee;
  margin: 0;
  padding: 20px;
}

#top {
  display: flex;
  gap: 10px;
}

#game-container {
  width: 480px;
  height: 360px;
  border: 1px solid #333;
}

#game-container iframe {
  width: 100%;
  height: 100%;
  border: none;
}

#ad-container {
  width: 360px;
  height: 360px;
  border: 1px solid #333;
  overflow: hidden;
}

#title {
  margin-top: 15px;
  cursor: pointer;
  font-size: 20px;
}

#content {
  display: none;
  margin-top: 5px;
  color: #ccc;
}

#buttons {
  margin-top: 15px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.button {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px;
  background: #222;
  border: 1px solid #333;
  cursor: pointer;
}

.button img {
  width: 32px;
  height: 32px;
  object-fit: contain;
}
</style>
</head>

<body>

<div id="top">
  <div id="game-container">
    <iframe src="jogo.html"></iframe>
  </div>

  <div id="ad-container"></div>
</div>

<div id="title"></div>
<div id="content"></div>

<div id="buttons"></div>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
fetch('config.xlsx')
  .then(res => res.arrayBuffer())
  .then(data => {
    const workbook = XLSX.read(data);
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

    const header = rows[0];

    // Linha 0 config
    if (header[0]) {
      const [h, w] = header[0].split('x').map(Number);
      document.getElementById('game-container').style.height = h + 'px';
      document.getElementById('game-container').style.width = w + 'px';
    }

    document.getElementById('title').innerText = header[1] || '';
    document.getElementById('content').innerText = header[2] || '';

    if (header[3]) {
      const adContainer = document.getElementById('ad-container');

      const iframe = document.createElement('iframe');
      iframe.style.border = 'none';
      iframe.style.width = '100%';
      iframe.style.height = '100%';

      iframe.srcdoc = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <style>body{margin:0;padding:0;}</style>
        </head>
        <body>
          ${header[3]}
        </body>
        </html>
        `;
  
      adContainer.appendChild(iframe);
    }

    if (header[4]) {
      const [h, w] = header[4].split('x').map(Number);
      document.getElementById('ad-container').style.height = h + 'px';
      document.getElementById('ad-container').style.width = w + 'px';
    }

    // Toggle título
    document.getElementById('title').onclick = () => {
      const c = document.getElementById('content');
      c.style.display = c.style.display === 'none' ? 'block' : 'none';
    };

    // Botões
    for (let i = 1; i < rows.length; i++) {
      const [icon, url, text] = rows[i];
      if (!url) continue;

      const btn = document.createElement('div');
      btn.className = 'button';
      btn.onclick = () => window.open(url, '_blank');

      if (icon) {
        const img = document.createElement('img');
        img.src = icon;
        btn.appendChild(img);
      }

      if (text) {
        const span = document.createElement('span');
        span.innerText = text;
        btn.appendChild(span);
      }

      document.getElementById('buttons').appendChild(btn);
    }
  });
  // Za Warudo! Stop The Time!
</script>

</body>
</html>
