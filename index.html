<!DOCTYPE html> 
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Game Container</title>
<link rel="icon" href="icon.png">
  
<style>

:root {
  --hover-color: #444;
}

body {
  font-family: Arial, sans-serif;
  background: #070707;
  color: #eee;
  margin: 0;
  padding: 20px;
}

#top {
  display: flex;
  gap: 10px;
}

#game-container {
  width: 480px;
  height: 360px;
  border: 1px solid #333;
}

#game-container iframe {
  width: 100%;
  height: 100%;
  border: none;
}

#ad-container {
  width: 360px;
  height: 360px;
  border: 1px solid #333;
  overflow: hidden;
}

#title {
  margin-top: 15px;
  cursor: pointer;
  font-size: 20px;
}

#title:hover {
  color: var(--hover-color);
}

#content {
  display: none;
  margin-top: 5px;
  color: #ccc;
}

#buttons {
  margin-top: 15px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.button {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  background: transparent;
  border: none;
  cursor: pointer;
  color: inherit;
  transition: background 0.3s;
}

.button:hover {
  background: linear-gradient(to right, transparent, var(--hover-color));
}

.button img {
  width: 32px;
  height: 32px;
  object-fit: contain;
}
</style>
</head>

<body>

<div id="top">
  <div id="game-container">
    <iframe src="jogo.html"></iframe>
  </div>

  <div id="ad-container"></div>
</div>

<div id="title"></div>
<div id="content"></div>

<div id="buttons"></div>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
fetch('config.xlsx')
  .then(res => res.arrayBuffer())
  .then(data => {
    const workbook = XLSX.read(data);
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

    const header = rows[0];

    const root = document.documentElement;

    if (header[5]) root.style.setProperty('--hover-color', header[5]);
    if (header[6]) document.body.style.background = header[6];
    if (header[7]) document.body.style.fontFamily = header[7];

    if (header[8]) {
      document.body.style.color = header[8];
    } else if (header[6]) {
      document.body.style.color =
        parseInt(header[6].replace('#',''),16) > 0xffffff/2 ? '#000' : '#fff';
    }

    
    // Linha 0 config
    let gameH = 360, gameW = 480;
  let adH = 360, adW = 360;

  if (header[0]) {
    [gameH, gameW] = header[0].split('x').map(Number);
  }

  if (header[4]) {
    [adH, adW] = header[4].split('x').map(Number);
  }

  const finalH = Math.max(gameH, adH);
  
  const game = document.getElementById('game-container');
  const ad = document.getElementById('ad-container');
  const top = document.getElementById('top');

  game.style.height = finalH + 'px';
  game.style.width = gameW + 'px';

  ad.style.height = finalH + 'px';
  ad.style.width = adW + 'px';

  top.style.marginTop = '5px';


    document.getElementById('title').innerText = header[1] || '';

    if (header[1]) {
      document.title = header[1];
    }

    document.getElementById('content').innerText = header[2] || '';

    if (header[3]) {
      const adContainer = document.getElementById('ad-container');

      const iframe = document.createElement('iframe');
      iframe.style.border = 'none';
      iframe.style.width = '100%';
      iframe.style.height = '100%';

      iframe.srcdoc = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <style>body{margin:0;padding:0;}</style>
        </head>
        <body>
          ${header[3]}
        </body>
        </html>
        `;
  
      adContainer.appendChild(iframe);
    }

    if (header[4]) {
      const [h, w] = header[4].split('x').map(Number);
      document.getElementById('ad-container').style.height = h + 'px';
      document.getElementById('ad-container').style.width = w + 'px';
    }

    // Toggle título
    document.getElementById('title').onclick = () => {
      const c = document.getElementById('content');
      c.style.display = c.style.display === 'none' ? 'block' : 'none';
    };

    // Botões
    for (let i = 1; i < rows.length; i++) {
      const [icon, url, text] = rows[i];
      if (!url) continue;

      const btn = document.createElement('div');
      btn.className = 'button';
      btn.onclick = () => window.open(url, '_blank');

      if (icon) {
        const img = document.createElement('img');
        img.src = icon;
        btn.appendChild(img);
      }

      if (text) {
        const span = document.createElement('span');
        span.innerText = text;
        btn.appendChild(span);
      }

      document.getElementById('buttons').appendChild(btn);
    }
  });
  //za warudo
</script>

</body>
</html>
